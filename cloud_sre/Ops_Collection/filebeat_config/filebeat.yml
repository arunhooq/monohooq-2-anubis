filebeat.modules:
  - module: nginx
    enabled: ${FILEBEAT_NGINX_MODULE:false}
    access:
      enabled: true
      var.paths: ["/var/log/nginx/*access*.log"]
    error:
      enabled: true
      var.paths: ["/var/log/nginx/*error*.log"]

filebeat.inputs:
  - type: log
    enabled: ${FILEBEAT_LOG_INPUT:false}
    json.keys_under_root: true
    json.overwrite_keys: true
    paths:
      - /var/log/pm2/*.log

cloud.id: "${ELASTIC_CLOUD_ID}"
cloud.auth: "${ELASTIC_CLOUD_AUTH}"

fields:
  env: "${ENVIRONMENT}"

setup:
  template:
    enabled: true
    name: "hooq-${LOG_TYPE:application}-logs-${SERVICE_NAME}-template"
    pattern: "hooq-${LOG_TYPE:application}-logs-${SERVICE_NAME}-*"
    settings:
      index.number_of_shards: 1
      index.number_of_replicas: 1
  ilm:
    enabled: auto
    rollover_alias: "hooq-${LOG_TYPE:application}-logs-${SERVICE_NAME}"
    policy_name: "hooq-${LOG_TYPE:application}-logs-ilm"

output.elasticsearch.index: "hooq-${LOG_TYPE:application}-logs-${SERVICE_NAME}-%{+yyyy.MM.dd}"
